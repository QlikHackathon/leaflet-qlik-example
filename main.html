<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title></title>
    <link rel="stylesheet" href="https://playground.qlik.com/playground/resources/autogenerated/qlik-styles.css">
    <style>
     .info {
    padding: 6px 8px;
    font: 14px/16px Arial, Helvetica, sans-serif;
    background: white;
    background: rgba(255,255,255,0.8);
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    border-radius: 5px;
}
.info h4 {
    margin: 0 0 5px;
    color: #777;
}
    </style>
  </head>
  <body>
    <div id="container"></div>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script type="text/javascript" src="/node_modules/playground-js-api/dist/playground-js-api.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"></script>

    <script type="text/javascript" src="https://playground.qlik.com/playground/resources/assets/external/requirejs/require.js"></script>
    <script type="text/javascript" src="/resources/script.js"></script>
    <script type="text/javascript">
     $('#container')[0].setAttribute('style', "height:" + window.screen.availHeight + "px");
     var access_token = 'pk.eyJ1Ijoic2VyaW91c2JlbiIsImEiOiJjajhxam9kdnEwa2c5MndxcHBtcjZiZGlxIn0.sPq1wEDyoXKrPW-9ZjUnMA';
     window.map = L.map('container').setView([0, 10], 3);
     L.tileLayer('https://api.mapbox.com/styles/v1/seriousben/cj8qk0fysal2b2ss27kmivp75/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2VyaW91c2JlbiIsImEiOiJjajhxam9kdnEwa2c5MndxcHBtcjZiZGlxIn0.sPq1wEDyoXKrPW-9ZjUnMA', {
       maxZoom: 18,
       attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                    '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                    'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
       id: 'mapbox.streets'
     }).addTo(window.map);

     var info = L.control();

     info.onAdd = function (map) {
       this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
       this.update();
       return this._div;
     };

     // method that we will use to update the control based on feature properties passed
     info.update = function (props) {
       let count = "Hover over a Country or Ocean";
       if (props && props.numCommitments !== undefined) {
         count = props.numCommitments;
       } else if (window.grandTotal !== undefined) {
         count = window.grandTotal;
       }
       this._div.innerHTML = '<h3>Number of Commitments</h3> <h4>' + count + '</h4>';
     };

     info.addTo(window.map);

     main();
    </script>
  </body>
</html>
